<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Research Results</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#f8fafc;--surface:#fff;--border:#e2e8f0;--border-light:#f1f5f9;
  --text:#0f172a;--text-secondary:#475569;--text-muted:#94a3b8;
  --primary:#4f46e5;--primary-light:#e0e7ff;--primary-dark:#3730a3;
  --green:#059669;--green-light:#ecfdf5;--green-dark:#065f46;
  --red:#dc2626;--red-light:#fef2f2;
  --amber:#d97706;--amber-light:#fffbeb;
  --gold:#ca8a04;--silver:#64748b;--bronze:#b45309;
  --shadow-sm:0 1px 2px rgba(0,0,0,.05);
  --shadow:0 1px 3px rgba(0,0,0,.06),0 1px 2px rgba(0,0,0,.04);
  --shadow-md:0 4px 6px -1px rgba(0,0,0,.07),0 2px 4px -2px rgba(0,0,0,.05);
  --shadow-lg:0 10px 15px -3px rgba(0,0,0,.08),0 4px 6px -4px rgba(0,0,0,.04);
  --radius:.75rem;--radius-full:9999px;
}
body{font-family:Inter,-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;-webkit-font-smoothing:antialiased}
a{color:var(--primary);text-decoration:none}
a:hover{text-decoration:underline}

/* Header */
.header{background:linear-gradient(135deg,#1e1b4b 0%,#312e81 50%,#3730a3 100%);padding:2.5rem 1.5rem 2rem;color:#fff;position:relative;overflow:hidden}
.header::before{content:'';position:absolute;top:-50%;right:-20%;width:60%;height:200%;background:radial-gradient(circle,rgba(99,102,241,.15) 0%,transparent 70%);pointer-events:none}
.header-inner{max-width:1040px;margin:0 auto;position:relative;z-index:1}
.header h1{font-size:2rem;font-weight:800;letter-spacing:-.025em;margin-bottom:.625rem}
.header-meta{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem}
.meta-pill{display:inline-flex;align-items:center;gap:.375rem;background:rgba(255,255,255,.12);backdrop-filter:blur(8px);padding:.375rem .875rem;border-radius:var(--radius-full);font-size:.8125rem;font-weight:500;color:rgba(255,255,255,.9);border:1px solid rgba(255,255,255,.08)}
.tags{display:flex;flex-wrap:wrap;gap:.375rem}
.tag{background:rgba(255,255,255,.15);color:#fff;padding:.25rem .75rem;border-radius:var(--radius-full);font-size:.75rem;font-weight:500;border:1px solid rgba(255,255,255,.1)}

/* Recommendation */
.rec{max-width:1040px;margin:1.5rem auto 0;padding:0 1rem}
.rec-inner{padding:1.25rem 1.5rem;background:linear-gradient(135deg,var(--primary-light),#f0fdf4);border:1px solid #c7d2fe;border-radius:var(--radius);font-size:.925rem;color:#1e3a5f;line-height:1.7;display:flex;gap:.75rem;align-items:flex-start}
.rec-icon{font-size:1.25rem;flex-shrink:0;margin-top:.125rem}

/* Category Nav */
.cat-nav{max-width:1040px;margin:1.5rem auto .5rem;padding:0 1rem}
.cat-pills{display:flex;flex-wrap:wrap;gap:.5rem;padding:.25rem 0}
.cat-pill{display:inline-flex;align-items:center;gap:.375rem;padding:.5rem 1.125rem;border-radius:var(--radius-full);font-size:.875rem;font-weight:500;cursor:pointer;border:1.5px solid var(--border);background:var(--surface);color:var(--text-secondary);transition:all .2s ease;user-select:none}
.cat-pill:hover{border-color:var(--primary);color:var(--primary);background:var(--primary-light)}
.cat-pill.active{background:var(--primary);color:#fff;border-color:var(--primary);box-shadow:0 2px 8px rgba(79,70,229,.25)}
.cat-pill .count{display:inline-flex;align-items:center;justify-content:center;min-width:1.375rem;height:1.375rem;padding:0 .375rem;border-radius:var(--radius-full);font-size:.7rem;font-weight:600;background:rgba(0,0,0,.06);color:var(--text-muted)}
.cat-pill.active .count{background:rgba(255,255,255,.25);color:#fff}

/* Category Section */
.cat-section{max-width:1040px;margin:0 auto;padding:0 1rem}
.cat-header{padding:1.5rem 0 .75rem;display:flex;align-items:baseline;gap:.75rem}
.cat-header h2{font-size:1.375rem;font-weight:700;letter-spacing:-.015em}
.cat-desc{font-size:.875rem;color:var(--text-muted)}

/* Product Grid */
.products{display:flex;flex-direction:column;gap:1rem;padding-bottom:1rem}

/* Product Card */
.card{background:var(--surface);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid var(--border);overflow:hidden;transition:box-shadow .25s ease,transform .25s ease;animation:cardIn .35s ease both}
.card:hover{box-shadow:var(--shadow-lg);transform:translateY(-2px)}
@keyframes cardIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

/* Card Header */
.card-top{display:flex;align-items:center;gap:.75rem;padding:1rem 1.5rem;border-bottom:1px solid var(--border-light);background:var(--bg)}
.rank-badge{display:inline-flex;align-items:center;justify-content:center;width:2.125rem;height:2.125rem;border-radius:.5rem;font-weight:800;font-size:.875rem;color:#fff;flex-shrink:0}
.rank-1{background:linear-gradient(135deg,#eab308,var(--gold));box-shadow:0 2px 6px rgba(202,138,4,.3)}
.rank-2{background:linear-gradient(135deg,#94a3b8,var(--silver));box-shadow:0 2px 6px rgba(100,116,139,.25)}
.rank-3{background:linear-gradient(135deg,#f59e0b,var(--bronze));box-shadow:0 2px 6px rgba(180,83,9,.25)}
.rank-n{background:linear-gradient(135deg,#cbd5e1,#94a3b8)}
.card-title{font-size:1.0625rem;font-weight:650;flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.card-price{font-size:1.125rem;font-weight:700;color:var(--green);white-space:nowrap}

/* Card Body */
.card-body{display:grid;grid-template-columns:180px 1fr;gap:1.5rem;padding:1.5rem}
@media(max-width:640px){.card-body{grid-template-columns:1fr;gap:1rem}}

.prod-img{width:180px;height:180px;border-radius:.625rem;object-fit:contain;background:var(--bg);border:1px solid var(--border-light);align-self:start;transition:transform .3s ease}
.prod-img:hover{transform:scale(1.03)}
.img-placeholder{width:180px;height:180px;border-radius:.625rem;background:var(--bg);border:1px solid var(--border-light);display:flex;align-items:center;justify-content:center;font-size:3rem;color:var(--border)}
@media(max-width:640px){.prod-img,.img-placeholder{width:100%;height:220px}}

.details{min-width:0;display:flex;flex-direction:column;gap:.5rem}
.rating-row{display:flex;align-items:center;gap:.5rem;font-size:.875rem}
.stars{color:var(--gold);letter-spacing:.5px;font-size:1rem}
.rating-num{font-weight:700;color:var(--text)}
.rating-src{color:var(--text-muted);font-size:.8125rem}
.price-range{font-size:.825rem;color:var(--text-muted);background:var(--bg);display:inline-block;padding:.1875rem .625rem;border-radius:.25rem}
.best-for{display:inline-flex;align-items:center;gap:.25rem;background:var(--green-light);color:var(--green-dark);padding:.3125rem .75rem;border-radius:var(--radius-full);font-size:.8rem;font-weight:500}
.highlights{font-size:.9rem;color:var(--text-secondary);line-height:1.65}

/* Pros/Cons */
.pros-cons{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem;padding:0 1.5rem 1.25rem}
@media(max-width:640px){.pros-cons{grid-template-columns:1fr}}
.pc-col h4{font-size:.75rem;font-weight:700;text-transform:uppercase;letter-spacing:.06em;margin-bottom:.5rem;display:flex;align-items:center;gap:.375rem}
.pc-col.pros h4{color:var(--green)}
.pc-col.cons h4{color:var(--red)}
.pc-col ul{list-style:none;font-size:.85rem;line-height:1.6}
.pc-col li{padding:.1875rem 0 .1875rem 1.375rem;position:relative}
.pc-col.pros li::before{content:'\2713';position:absolute;left:0;color:var(--green);font-weight:700;font-size:.8rem}
.pc-col.cons li::before{content:'\2717';position:absolute;left:0;color:var(--red);font-weight:700;font-size:.8rem}

/* Buy Links */
.buy-bar{padding:1rem 1.5rem;border-top:1px solid var(--border-light);background:var(--bg);display:flex;flex-wrap:wrap;align-items:center;gap:.625rem}
.buy-bar-label{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);margin-right:.25rem}
.buy-btn{display:inline-flex;align-items:center;gap:.375rem;padding:.5rem 1.125rem;background:var(--green);color:#fff;border-radius:.5rem;font-size:.8125rem;font-weight:600;text-decoration:none;transition:all .15s ease;box-shadow:var(--shadow-sm)}
.buy-btn:hover{background:var(--green-dark);text-decoration:none;box-shadow:var(--shadow);transform:translateY(-1px)}
.buy-btn .bp{font-weight:400;opacity:.85;margin-left:.125rem}
.buy-btn .arrow{opacity:.6;font-size:.7rem;margin-left:.125rem}

/* Footer */
.footer{max-width:1040px;margin:1rem auto;padding:1.5rem 1rem 3rem;text-align:center;font-size:.8rem;color:var(--text-muted)}

/* Empty */
.empty{max-width:1040px;margin:6rem auto;text-align:center;color:var(--text-muted)}
.empty-icon{font-size:3rem;margin-bottom:1rem}
.empty h2{font-size:1.375rem;margin-bottom:.5rem;color:var(--text-secondary)}
</style>
</head>
<body>
<div id="app"></div>
<script>
const DATA = __PRODUCT_DATA__;

function esc(s){if(!s)return'';const d=document.createElement('div');d.textContent=s;return d.innerHTML}

function stars(r){
  const f=Math.floor(r),h=r-f>=.4?1:0,e=5-f-h;
  return '\u2605'.repeat(f)+(h?'\u00BD':'')+'\u2606'.repeat(e);
}

function rankCls(i){return i===0?'rank-badge rank-1':i===1?'rank-badge rank-2':i===2?'rank-badge rank-3':'rank-badge rank-n'}

function normalize(data){
  if(data.categories?.length)return data.categories;
  const prods=data.products||[];
  if(!prods.length)return[];
  const grouped={};
  let hasCategories=false;
  for(const p of prods){
    const cat=p.category||'';
    if(cat)hasCategories=true;
    if(!grouped[cat])grouped[cat]=[];
    grouped[cat].push(p);
  }
  if(!hasCategories)return[{name:'',products:prods}];
  return Object.entries(grouped).map(([name,products])=>({name,products}));
}

function renderBuyLinks(links){
  if(!links||!links.length)return'';
  return`<div class="buy-bar"><span class="buy-bar-label">Buy at</span>${
    links.map(l=>`<a href="${esc(l.url)}" class="buy-btn" target="_blank" rel="noopener">${esc(l.store)}${l.price?` <span class="bp">${esc(String(l.price))}</span>`:''}<span class="arrow">\u2197</span></a>`).join('')
  }</div>`;
}

function renderCard(p,i){
  const img=p.image
    ?`<img src="${esc(p.image)}" alt="${esc(p.name)}" class="prod-img" loading="lazy" onerror="this.outerHTML='<div class=\\'img-placeholder\\'>&#128230;</div>'">`
    :`<div class="img-placeholder">\u{1F4E6}</div>`;
  const ratingHtml=p.rating
    ?`<div class="rating-row"><span class="stars">${stars(p.rating)}</span><span class="rating-num">${p.rating}</span>${p.ratingSource?`<span class="rating-src">\u00b7 ${esc(p.ratingSource)}</span>`:''}</div>`:'';
  const pr=p.priceRange?`<span class="price-range">${esc(p.priceRange)}</span>`:'';
  const bf=p.bestFor?`<span class="best-for">\u{1F3AF} ${esc(p.bestFor)}</span>`:'';
  const hl=p.highlights?`<div class="highlights">${esc(p.highlights)}</div>`:'';
  const prosH=p.pros?.length?`<div class="pc-col pros"><h4>\u2713 Pros</h4><ul>${p.pros.map(x=>`<li>${esc(x)}</li>`).join('')}</ul></div>`:'';
  const consH=p.cons?.length?`<div class="pc-col cons"><h4>\u2717 Cons</h4><ul>${p.cons.map(x=>`<li>${esc(x)}</li>`).join('')}</ul></div>`:'';
  const price=p.price?`<span class="card-price">${esc(String(p.price))}</span>`:'';
  const delay=i*.06;
  return`<div class="card" style="animation-delay:${delay}s">
    <div class="card-top"><span class="${rankCls(i)}">${p.rank||i+1}</span><span class="card-title">${esc(p.name)}</span>${price}</div>
    <div class="card-body">${img}<div class="details">${ratingHtml}${pr}${bf}${hl}</div></div>
    ${prosH||consH?`<div class="pros-cons">${prosH}${consH}</div>`:''}
    ${renderBuyLinks(p.buyLinks)}
  </div>`;
}

function render(){
  const cats=normalize(DATA);
  if(!cats.length||!cats.some(c=>c.products?.length)){
    document.getElementById('app').innerHTML='<div class="empty"><div class="empty-icon">\u{1F50D}</div><h2>No products found</h2><p>Research data is missing or empty.</p></div>';
    return;
  }
  const m=DATA.metadata||{};
  const metaParts=[];
  if(m.date)metaParts.push(`<span class="meta-pill">\u{1F4C5} ${esc(m.date)}</span>`);
  if(m.location)metaParts.push(`<span class="meta-pill">\u{1F4CD} ${esc(m.location)}</span>`);
  if(m.budget)metaParts.push(`<span class="meta-pill">\u{1F4B0} ${esc(m.budget)}</span>`);
  const tags=(m.priorities||[]).map(t=>`<span class="tag">${esc(t)}</span>`).join('');
  const recHtml=DATA.recommendation?`<div class="rec"><div class="rec-inner"><span class="rec-icon">\u{1F4A1}</span><span>${esc(DATA.recommendation)}</span></div></div>`:'';

  const showCatNav=cats.length>1||cats[0].name;
  const totalProducts=cats.reduce((s,c)=>s+(c.products||[]).length,0);
  let catNavHtml='';
  if(showCatNav){
    const allPill=`<button class="cat-pill active" data-cat="__all__">All<span class="count">${totalProducts}</span></button>`;
    const pills=cats.map(c=>`<button class="cat-pill" data-cat="${esc(c.name)}">${esc(c.name)}<span class="count">${(c.products||[]).length}</span></button>`).join('');
    catNavHtml=`<div class="cat-nav"><div class="cat-pills">${allPill}${pills}</div></div>`;
  }

  let sectionsHtml='';
  cats.forEach(c=>{
    const hdr=c.name?`<div class="cat-header"><h2>${esc(c.name)}</h2>${c.description?`<span class="cat-desc">${esc(c.description)}</span>`:''}</div>`:'';
    const cards=(c.products||[]).map((p,i)=>renderCard(p,i)).join('');
    sectionsHtml+=`<div class="cat-section" data-cat-section="${esc(c.name)}">${hdr}<div class="products">${cards}</div></div>`;
  });

  document.getElementById('app').innerHTML=`
    <div class="header"><div class="header-inner">
      <h1>${esc(m.query||'Product Research Results')}</h1>
      ${metaParts.length?`<div class="header-meta">${metaParts.join('')}</div>`:''}
      ${tags?`<div class="tags">${tags}</div>`:''}
    </div></div>
    ${recHtml}${catNavHtml}${sectionsHtml}
    <div class="footer">Research compiled by AI Product Researcher \u00b7 Prices and availability may change \u00b7 Always verify before purchasing</div>`;

  if(showCatNav)initCatNav();
  document.title=m.query?`${m.query} \u2014 Product Research`:'Product Research Results';
}

function initCatNav(){
  const pills=document.querySelectorAll('.cat-pill');
  const sections=document.querySelectorAll('.cat-section');
  pills.forEach(pill=>{
    pill.addEventListener('click',()=>{
      pills.forEach(p=>{p.classList.remove('active')});
      pill.classList.add('active');
      const cat=pill.dataset.cat;
      sections.forEach(s=>{
        if(cat==='__all__'){s.style.display='';reanimateCards(s)}
        else{
          const match=s.dataset.catSection===cat;
          s.style.display=match?'':'none';
          if(match)reanimateCards(s);
        }
      });
    });
  });
}

function reanimateCards(section){
  section.querySelectorAll('.card').forEach((c,i)=>{
    c.style.animation='none';
    c.offsetHeight;
    c.style.animation=`cardIn .35s ease both`;
    c.style.animationDelay=`${i*.06}s`;
  });
}

render();
</script>
</body>
</html>
